---
import background from "../assets/bg-red.jpg";
---

<div id="global-bg-wrapper" transition:persist="global-bg">
    <img id="background" src={background.src} alt="" fetchpriority="high" />
</div>

<script>
    function updateBackground() {
        const bg = document.getElementById("background");
        if (!bg) return;

        const path = window.location.pathname;
        let hue = 0;

        if (path.startsWith("/projects")) {
            hue = 290; // Purple/Blue-ish shift
        } else if (path.startsWith("/blog")) {
            hue = 200; // Blue/Cyan shift
        } else {
            hue = 20; // Default Red
        }

        bg.style.filter = `blur(19px) hue-rotate(${hue}deg)`;
    }

    // running on initial load
    updateBackground();

    // running on subsequent navigations
    document.addEventListener("astro:page-load", updateBackground);
</script>

<style>
    #global-bg-wrapper {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -50;
        pointer-events: none;
        overflow: hidden;
    }

    #background {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: scale(1.1);
        transition: filter 0.7s ease-in-out;
        filter: blur(19px) hue-rotate(0deg); /* Default state */
    }
</style>
